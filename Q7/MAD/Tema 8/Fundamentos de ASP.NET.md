[[Tema 8-Introducción a ASP.NET]]

## Qué es ASP.NET?
> [!abstract] Definición de ASP.NET
> Es un framework de programación web que evoluciona de las Active Server Pages

Permite acceder a las clases del framework .NET. La idea es poder desarrollar aplicaciones web similares a como se haría para aplicaciones nativas de Windows. Se puede utilizar cualquier lenguaje soportado por .NET.

Se basa en un componente principal, el `WebForm`.

## Tipos de proyectos web
Visual Studio ofrece dos modos de crear aplicaciones .NET:
+ **Website:** no se desarrolla un proyecto complejo. Todos los archivos dentro del directorio del sitio web son parte de la aplicación. Se compila el código con precompilación o la primera vez que se solicita la página. Despliega los archivos `aspx.`.
+ **Web Project:** se desarrolla un proyecto complejo. Se crea un archivo `.csproj` que almacena los archivos que pertenecen al proyecto y características de depuración. Al ejecutarlo, se compila todo el proyecto a un ensamblado y se lanza el navegador. Al desplegarlo se utilizan el ensamblado y los archivos `.aspx`. Se utiliza en proyectos grandes.

### Web Project en VS
VS permite añadir los componentes de la página web, como botones, etiquetas, etc. desde la caja de herramientas en lugar de escribir tanto código. 

El explorador de soluciones contiene:
+ **.aspx:** páginas web.
+ **.ascx:** controles de usuario.
+ **.asmx o .svc:** servicios web de ASP.NET.
+ **web.config:** archivo de configuración de la aplicación web.
+ **global.asax:** archivo de definición de variables globales y eventos de aplicación.
+ **.cs:** code-behind asociado a una página.
+ **.master:** páginas maestras.
+ **Otros archivos:** directorios de imágenes, fuentes, CSS, etc.

## Modelos de código
Existen dos formas de hacer el código de las páginas web:
+ Inline code.
+ Code-behind.

### Inline code
Solo funciona en Website. El código se coloca en etiquetas `<script>`. Permite debug, intelliSense, etc.

```csharp
<%@ Page Language="C#" %>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<script runat="server">
    protected void Button1_Click(object sender, EventArgs e)
    {
        Label1.Text = "Current time: " + DateTime.Now.ToLongTimeString();
    }
</script>
<html xmlns="http://www.w3.org/1999/xhtml">
<head id="Head1" runat="server">
    <title>Test Page</title>
</head>
<body>
    <form id="form1" runat="server">
        <div>
            <asp:Label ID="Label1" runat="server" Text="Click Me!" />
            <br />
            <asp:Button ID="Button1" runat="server" OnClick="Button1_Click" Text="Button" />
        </div>
    </form>
</body>
</html>
```

### Code-behind
Separa las páginas en ficheros `.aspx`, que contiene el HTML, y ficheros `.aspx.cs`, que contienen el código. Además crea ficheros `.aspx.designer.cs`, con definiciones de controles generados automáticamente. Se pueden usar tanto en Website como en Web projects. La ventaja es que separa la interfaz de la lógica.

```csharp
// aspx

<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="TestFormCodeBehind.aspx.cs"
    Inherits="WebApplication.TestFormCodeBehind" %>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head id="Head1" runat="server">
    <title>Test Page</title>
</head>
<body>
    <form id="form1" runat="server">
        <div>
            <asp:Label ID="Label1" runat="server" Text="Click Me!"></asp:Label><br />
            <br />
            <br />
            <asp:Button ID="Button1" runat="server" OnClick="Button1_Click" Text="Button" />
        </div>
    </form>
</body>
</html>
```

```csharp
// .cs

using System;

namespace WebApplication
{
    public partial class TestFormCodeBehind : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {
        }

        protected void Button1_Click(object sender, EventArgs e)
        {
            this.Label1.Text = "Current time: " + DateTime.Now.ToLongTimeString();
        }
    }
}
```

```csharp
// designer

//------------------------------------------------------------------------------
// <auto-generated>
// This code was generated by a tool.
//
// Changes to this file may cause incorrect behavior and will be lost if
// the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------
namespace WebApplication
{
    public partial class TestFormCodeBehind
    {
        protected global::System.Web.UI.HtmlControls.HtmlHead Head1;
        protected global::System.Web.UI.HtmlControls.HtmlForm form1;
        protected global::System.Web.UI.WebControls.Label Label1;
        protected global::System.Web.UI.WebControls.Button Button1;
    }
}
```